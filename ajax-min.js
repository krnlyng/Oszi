function getCanvas(){return document.getElementById("gridCanvas")}function getCanvasContext(){return getCanvas().getContext("2d")}function canvas_line(a,b,c,e,d){a.beginPath();a.moveTo(b,c);a.lineTo(e,d);a.closePath();a.stroke()}function setCanvasStyle(a,b){getCanvasContext().strokeStyle=a?a:"#000000";b&&clearCanvas()}function clearCanvas(){var a=getCanvasContext();a.clearRect(0,0,getCanvas().width,getCanvas().height);a.fillStyle="#0b610b";a.fillRect(0,0,getCanvas().width,getCanvas().height)}
function draw_grid(){for(var a=getCanvas(),b=getCanvasContext(),c=a.width/10,e=a.height/10,d=0;d<=10;d++){var f=d*c,g=d*e;canvas_line(b,f,0,f,a.height);canvas_line(b,0,g,a.width,g)}}var ajaxBusy=false;
function ajax(a){if(!ajaxBusy){ajaxBusy=true;var b;b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){setCanvasStyle(null,true);draw_grid();var c=0,e=0,d=b.responseText.split(";");for(c=0;c<d.length;c++){e=parseInt(d[c],10)+127;v1=parseInt(d[c+1],10)+127;var f=getCanvasContext();setCanvasStyle("#11FF00");canvas_line(f,c,e,c+1,v1)}ajaxBusy=false;setTimeout("ajax('"+a+"')",500)}};b.open("GET",a,true);b.send()}}
function setServerParam(a,b){var c;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a!="reset"?c.open("GET","set_"+b,true):c.open("GET",b,true);c.send()}window.addEventListener("load",function(){setServerParam("reset","reset_preferences");document.getElementById("timescale").value="1ms"},false);function timescaleChanged(a){console.log("TIME/DIV changed to: "+a);setServerParam("time",a)}
function voltsChanged(a){console.log("VOLTS/DIV changed to: "+a);setServerParam("volts",a)}function couplingChanged(a){console.log("Toggle coupling");var b;if(a.value=="AC"){b="DC";setServerParam("coupling","dc")}else{b="AC";setServerParam("coupling","ac")}a.value=b};